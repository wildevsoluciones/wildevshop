{% extends "base.html" %}
{% block title %}{{ product.name }} | WilDev Shop{% endblock %}

{% block content %}
<div class="row g-3">

  <!-- Imagen -->
  <div class="col-12 col-lg-6">
    <div class="card card-wildev overflow-hidden">
      <img
        src="{{ product.image_url or url_for('static', filename='img/no-image.png') }}"
        class="w-100"
        alt="{{ product.name }}">
    </div>
  </div>

  <!-- Detalle -->
  <div class="col-12 col-lg-6">
    <div class="card card-wildev p-4 h-100">

      <!-- Título + precio -->
      <div class="d-flex justify-content-between align-items-start gap-3">
        <div>
          <h3 class="fw-bold mb-1 text-wildev-title">
            {{ product.name }}
          </h3>
          <div class="text-wildev-meta small">
            {{ product.category }}
          </div>
        </div>

        <div class="price-big">
          {{ money_ars(product.price) }}
        </div>
      </div>

      <hr class="border-secondary opacity-25 my-3">

      <!-- Descripción -->
      <p class="text-wildev-body">
        {{ product.description }}
      </p>

      <!-- Stock -->
      <div class="mt-3 text-wildev-meta">
        Stock disponible:
        <span class="stock-pill {% if product.stock < 5 %}low{% else %}ok{% endif %}">
          {{ product.stock }}
        </span>
      </div>

      <!-- Acciones -->
      <form
        class="mt-3 d-flex flex-column flex-sm-row gap-2"
        action="{{ url_for('cart_add', product_id=product.id) }}"
        method="post">

        <div class="d-flex align-items-center gap-2">
          <label class="small text-wildev-meta" for="qty">
            Cantidad
          </label>
          <input
            id="qty"
            name="qty"
            type="number"
            min="1"
            max="{{ product.stock }}"
            value="1"
            class="form-control input-wildev"
            style="max-width:110px"
            {% if product.stock == 0 %}disabled{% endif %}>
        </div>

        <button
          class="btn btn-wildev flex-grow-1"
          type="submit"
          {% if product.stock == 0 %}disabled{% endif %}>
          {% if product.stock == 0 %}
            Sin stock
          {% else %}
            Agregar al carrito
          {% endif %}
        </button>

        <a class="btn btn-outline-light" href="{{ url_for('cart_view') }}">
          Ir al carrito
        </a>
      </form>

    </div>
  </div>

</div>
{% endblock %}
